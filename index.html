<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.6">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!DOCTYPE html&gt;</p>
<p class="p1">&lt;html lang="it"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;meta charset="UTF-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;title&gt;Preventivi Fattoria di Nonno Totò&lt;/title&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;!-- PDF Generation --&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"&gt;&lt;/script&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>* {</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin: 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>box-sizing: border-box;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>body {</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-family: Arial, sans-serif;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: linear-gradient(135deg, #3d5a3d 0%, #5a7c5a 50%, #b8860b 100%);</p>
<p class="p1"><span class="Apple-converted-space">            </span>min-height: 100vh;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 20px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.container {</p>
<p class="p1"><span class="Apple-converted-space">            </span>max-width: 900px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin: 0 auto;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: rgba(255, 255, 255, 0.95);</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 30px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.header {</p>
<p class="p1"><span class="Apple-converted-space">            </span>text-align: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 30px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.logo {</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 120px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>height: 120px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin: 0 auto 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: linear-gradient(135deg, #3d5a3d 0%, #b8860b 100%);</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 50%;</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">            </span>align-items: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>justify-content: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: white;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 12px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-weight: bold;</p>
<p class="p1"><span class="Apple-converted-space">            </span>text-align: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>box-shadow: 0 10px 30px rgba(0,0,0,0.2);</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: 3px solid #b8860b;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>h1 {</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #3d5a3d;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 2.5em;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.form-section {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: rgba(245, 245, 245, 0.5);</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 25px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 15px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-left: 5px solid #3d5a3d;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.form-section h3 {</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #3d5a3d;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 1.3em;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.form-row {</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: grid;</p>
<p class="p1"><span class="Apple-converted-space">            </span>grid-template-columns: 1fr 1fr;</p>
<p class="p1"><span class="Apple-converted-space">            </span>gap: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 20px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.form-group {</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 20px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>label {</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: block;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 8px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-weight: bold;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #3d5a3d;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>input, select, textarea {</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 100%;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 12px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: 2px solid #ddd;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 10px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 16px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>input:focus, select:focus, textarea:focus {</p>
<p class="p1"><span class="Apple-converted-space">            </span>outline: none;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-color: #3d5a3d;</p>
<p class="p1"><span class="Apple-converted-space">            </span>box-shadow: 0 0 10px rgba(61, 90, 61, 0.3);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.counter-group {</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">            </span>align-items: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>gap: 15px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.counter {</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">            </span>align-items: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: #f8f9fa;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 10px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: 2px solid #ddd;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.counter button {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: #3d5a3d;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: white;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: none;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 10px 15px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>cursor: pointer;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 18px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.counter button:hover {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: #2d4a2d;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.counter input {</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: none;</p>
<p class="p1"><span class="Apple-converted-space">            </span>text-align: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 60px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 10px 5px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: #f8f9fa;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.menu-selection {</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: grid;</p>
<p class="p1"><span class="Apple-converted-space">            </span>grid-template-columns: 1fr 1fr;</p>
<p class="p1"><span class="Apple-converted-space">            </span>gap: 20px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.menu-card {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: white;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 10px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: 2px solid #ddd;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.menu-card h4 {</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #3d5a3d;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 15px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 1.2em;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.menu-option {</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 10px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 10px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: #f8f9fa;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 8px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: 1px solid #e9ecef;</p>
<p class="p1"><span class="Apple-converted-space">            </span>cursor: pointer;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.menu-option input {</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: auto;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-right: 10px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.checkbox-group {</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">            </span>gap: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>flex-wrap: wrap;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.checkbox-item {</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">            </span>align-items: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>gap: 8px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: #f8f9fa;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 10px 15px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 10px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: 2px solid #e9ecef;</p>
<p class="p1"><span class="Apple-converted-space">            </span>cursor: pointer;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.checkbox-item input {</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: auto;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.btn {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: linear-gradient(45deg, #3d5a3d, #b8860b);</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: white;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 15px 30px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: none;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 10px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 18px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>cursor: pointer;</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 100%;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin: 20px 0;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.btn:hover {</p>
<p class="p1"><span class="Apple-converted-space">            </span>transform: translateY(-2px);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.btn-group {</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">            </span>gap: 10px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin: 20px 0;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.btn-secondary {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: linear-gradient(45deg, #6c757d, #495057);</p>
<p class="p1"><span class="Apple-converted-space">            </span>flex: 1;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.btn-success {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: linear-gradient(45deg, #28a745, #20c997);</p>
<p class="p1"><span class="Apple-converted-space">            </span>flex: 1;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.status-panel {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: rgba(40, 167, 69, 0.1);</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: 1px solid #28a745;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 10px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 15px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin: 20px 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>text-align: center;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.numero-preventivo {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: linear-gradient(45deg, #3d5a3d, #b8860b);</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: white;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 10px 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 10px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: inline-block;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-weight: bold;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 15px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.preventivo {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: linear-gradient(135deg, #3d5a3d 0%, #b8860b 100%);</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: white;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 30px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 15px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-top: 30px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.preventivo h2 {</p>
<p class="p1"><span class="Apple-converted-space">            </span>text-align: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 2em;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.dettagli {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: rgba(255,255,255,0.1);</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 10px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin: 20px 0;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.voce-preventivo {</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">            </span>justify-content: space-between;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin: 10px 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 8px 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-bottom: 1px solid rgba(255,255,255,0.3);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.totale {</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 1.5em;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-weight: bold;</p>
<p class="p1"><span class="Apple-converted-space">            </span>text-align: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-top: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 15px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: rgba(255,255,255,0.2);</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 10px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>@media (max-width: 768px) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>.form-row, .menu-selection {</p>
<p class="p1"><span class="Apple-converted-space">                </span>grid-template-columns: 1fr;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div class="container"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="header"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="logo"&gt;🌳🚜&lt;br&gt;Fattoria&lt;br&gt;Nonno Totò&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;h1&gt;Sistema Preventivi&lt;/h1&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;form id="preventivoForm"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- Dati Cliente --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="form-section"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;h3&gt;👤 Dati Cliente&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="form-row"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="form-group"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;label for="nome"&gt;Nome *:&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;input type="text" id="nome" required&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="form-group"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;label for="cognome"&gt;Cognome *:&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;input type="text" id="cognome" required&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="form-row"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="form-group"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;label for="dataNascita"&gt;Data di Nascita *:&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;input type="date" id="dataNascita" required&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="form-group"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;label for="telefono"&gt;Telefono:&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;input type="tel" id="telefono"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="form-group"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;label for="email"&gt;Email:&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;input type="email" id="email"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- Informazioni Evento --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="form-section"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;h3&gt;📅 Informazioni Evento&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="form-row"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="form-group"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;label for="data"&gt;Data Evento:&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;input type="date" id="data" required&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="form-group"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;label for="ora"&gt;Ora Evento:&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;input type="time" id="ora" required&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="form-group"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;label for="spazio"&gt;Spazio Richiesto:&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;select id="spazio" required&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;option value=""&gt;Seleziona spazio&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;option value="sala1"&gt;Sala Interna 1 (40 posti)&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;option value="sala2"&gt;Sala Interna 2 (70 posti)&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;option value="esterno"&gt;Spazio Esterno (200 posti)&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;option value="sale"&gt;Entrambe le Sale (110 posti)&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;option value="tutto"&gt;Tutto l'Agriturismo (200 posti)&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/select&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- Numero Partecipanti --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="form-section"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;h3&gt;👥 Numero Partecipanti&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="form-row"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="form-group"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;label&gt;Adulti:&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="counter-group"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="counter"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;button type="button" onclick="changeCount('adulti', -1)"&gt;-&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;input type="number" id="adulti" min="0" max="200" value="20" readonly&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;button type="button" onclick="changeCount('adulti', 1)"&gt;+&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="form-group"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;label&gt;Bambini:&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="counter-group"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="counter"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;button type="button" onclick="changeCount('bambini', -1)"&gt;-&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;input type="number" id="bambini" min="0" max="50" value="0" readonly&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;button type="button" onclick="changeCount('bambini', 1)"&gt;+&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="form-group"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div style="text-align: center; padding: 10px; background: #e8f4f8; border-radius: 8px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;strong&gt;Totale Ospiti: &lt;span id="totaleOspiti"&gt;20&lt;/span&gt;&lt;/strong&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- Menu Selection --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="form-section"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;h3&gt;🍽️ Selezione Menu&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="menu-selection"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="menu-card"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;h4&gt;Menu Adulti&lt;/h4&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="menu-option"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;input type="radio" name="menuAdulti" value="rosticceria" id="adulti-rosticceria"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;label for="adulti-rosticceria"&gt;Rosticceria - €14&lt;br&gt;&lt;small&gt;500g di porzione&lt;/small&gt;&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="menu-option"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;input type="radio" name="menuAdulti" value="bbq" id="adulti-bbq"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;label for="adulti-bbq"&gt;American BBQ - €40&lt;br&gt;&lt;small&gt;Ali, ribs, pulled pork, pannocchia, salsiccia&lt;/small&gt;&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="menu-option"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;input type="radio" name="menuAdulti" value="pizza" id="adulti-pizza"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;label for="adulti-pizza"&gt;Menu Pizza - €25&lt;br&gt;&lt;small&gt;Pizza 3 gusti + friggitoria&lt;/small&gt;&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="menu-card"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;h4&gt;Menu Bambini&lt;/h4&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="menu-option"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;input type="radio" name="menuBambini" value="pasta" id="bambini-pasta"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;label for="bambini-pasta"&gt;Pasta &amp; Polpette - €7.99&lt;br&gt;&lt;small&gt;Pennette al sugo + polpette/nuggets&lt;/small&gt;&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="menu-option"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;input type="radio" name="menuBambini" value="panino" id="bambini-panino"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;label for="bambini-panino"&gt;Panino &amp; Pizza - €7.99&lt;br&gt;&lt;small&gt;Panino prosciutto + pizzetta + patatine&lt;/small&gt;&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="menu-option"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;input type="radio" name="menuBambini" value="no-menu" id="bambini-no"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;label for="bambini-no"&gt;Nessun menu bambini&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- Postazioni Street Food --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="form-section"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;h3&gt;🍕 Postazioni Street Food (fino a 50 persone)&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="checkbox-group"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="checkbox-item"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;input type="checkbox" id="streetPizza"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;label for="streetPizza"&gt;Pizza 2 Gusti - €500&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="checkbox-item"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;input type="checkbox" id="streetSpritz"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;label for="streetSpritz"&gt;Spritz - €300&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="checkbox-item"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;input type="checkbox" id="streetBbq"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;label for="streetBbq"&gt;American BBQ - €500&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="checkbox-item"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;input type="checkbox" id="streetFriggitoria"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;label for="streetFriggitoria"&gt;Friggitoria Napoletana - €350&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="checkbox-item"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;input type="checkbox" id="streetGraffe"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;label for="streetGraffe"&gt;Graffe - €250&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div style="background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 8px; padding: 15px; margin-top: 15px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;small&gt;&lt;strong&gt;⚠️ Nota:&lt;/strong&gt; Le postazioni street food sono disponibili solo per eventi fino a 50 persone&lt;/small&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- Servizi Aggiuntivi --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="form-section"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;h3&gt;🎉 Servizi Aggiuntivi&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="checkbox-group"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="checkbox-item"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;input type="checkbox" id="animazione"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;label for="animazione"&gt;Animazione - €150&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="checkbox-item"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;input type="checkbox" id="allestimento"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;label for="allestimento"&gt;Allestimento Base - €150&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="form-group" style="margin-top: 20px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;label for="altriServizi"&gt;Altri Servizi Personalizzati:&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;textarea id="altriServizi" placeholder="Descrivi altri servizi richiesti (DJ, fotografo, decorazioni speciali, ecc.)"&gt;&lt;/textarea&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- Note --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="form-section"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;h3&gt;📝 Note Aggiuntive&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="form-group"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;label for="note"&gt;Richieste Speciali:&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;textarea id="note" placeholder="Inserisci eventuali richieste speciali"&gt;&lt;/textarea&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- Configurazione Google Sheets --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="form-section" style="background: rgba(40, 167, 69, 0.1); border-left-color: #28a745;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;h3&gt;🔗 Configurazione Database (Opzionale)&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="form-group"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;label for="googleSheetUrl"&gt;URL Google Sheet (per salvare i preventivi):&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;input type="url" id="googleSheetUrl" placeholder="https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;small style="color: #666;"&gt;Lascia vuoto se non vuoi salvare nel database.&lt;/small&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;button type="submit" class="btn"&gt;Genera Preventivo&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/form&gt;</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div id="risultato"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;script&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>// Variabili globali</p>
<p class="p1"><span class="Apple-converted-space">        </span>var ultimoPreventivo = null;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Genera numero preventivo</p>
<p class="p1"><span class="Apple-converted-space">        </span>function generaNumeroPreventivo() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>var oggi = new Date();</p>
<p class="p1"><span class="Apple-converted-space">            </span>var anno = oggi.getFullYear();</p>
<p class="p1"><span class="Apple-converted-space">            </span>var mese = String(oggi.getMonth() + 1).padStart(2, '0');</p>
<p class="p1"><span class="Apple-converted-space">            </span>var giorno = String(oggi.getDate()).padStart(2, '0');</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Recupera il contatore dal localStorage o inizia da 1</p>
<p class="p1"><span class="Apple-converted-space">            </span>var contatore = localStorage.getItem('contatore_preventivi_' + anno + mese + giorno) || 1;</p>
<p class="p1"><span class="Apple-converted-space">            </span>var numeroPreventivo = 'FNT-' + anno + mese + giorno + '-' + String(contatore).padStart(3, '0');</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Incrementa e salva il contatore</p>
<p class="p1"><span class="Apple-converted-space">            </span>localStorage.setItem('contatore_preventivi_' + anno + mese + giorno, parseInt(contatore) + 1);</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>return numeroPreventivo;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Salva in Google Sheets</p>
<p class="p1"><span class="Apple-converted-space">        </span>async function salvaInGoogleSheets(datiPreventivo) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>var googleSheetUrl = document.getElementById('googleSheetUrl').value.trim();</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (!googleSheetUrl) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>return { success: false, message: "URL Google Sheets non configurato" };</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>try {</p>
<p class="p1"><span class="Apple-converted-space">                </span>var response = await fetch(googleSheetUrl, {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>method: 'POST',</p>
<p class="p1"><span class="Apple-converted-space">                    </span>mode: 'no-cors',</p>
<p class="p1"><span class="Apple-converted-space">                    </span>headers: {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>'Content-Type': 'application/json',</p>
<p class="p1"><span class="Apple-converted-space">                    </span>},</p>
<p class="p1"><span class="Apple-converted-space">                    </span>body: JSON.stringify(datiPreventivo)</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>return { success: true, message: "Preventivo salvato in Google Sheets" };</p>
<p class="p1"><span class="Apple-converted-space">            </span>} catch (error) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>console.error('Errore salvataggio Google Sheets:', error);</p>
<p class="p1"><span class="Apple-converted-space">                </span>return { success: false, message: "Errore nel salvataggio: " + error.message };</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Genera PDF</p>
<p class="p1"><span class="Apple-converted-space">        </span>function scaricaPDF() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (!ultimoPreventivo) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>alert('Genera prima un preventivo');</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>var { jsPDF } = window.jspdf;</p>
<p class="p1"><span class="Apple-converted-space">            </span>var doc = new jsPDF();</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Header con logo (testo)</p>
<p class="p1"><span class="Apple-converted-space">            </span>doc.setFontSize(20);</p>
<p class="p1"><span class="Apple-converted-space">            </span>doc.setTextColor(61, 90, 61);</p>
<p class="p1"><span class="Apple-converted-space">            </span>doc.text('🌳🚜 Fattoria di Nonno Totò', 20, 25);</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>doc.setFontSize(12);</p>
<p class="p1"><span class="Apple-converted-space">            </span>doc.setTextColor(0, 0, 0);</p>
<p class="p1"><span class="Apple-converted-space">            </span>doc.text('Sistema Gestione Preventivi', 20, 35);</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Numero preventivo</p>
<p class="p1"><span class="Apple-converted-space">            </span>doc.setFontSize(14);</p>
<p class="p1"><span class="Apple-converted-space">            </span>doc.setTextColor(184, 134, 11);</p>
<p class="p1"><span class="Apple-converted-space">            </span>doc.text('Preventivo N°: ' + ultimoPreventivo.numero, 20, 50);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Dati cliente</p>
<p class="p1"><span class="Apple-converted-space">            </span>doc.setFontSize(12);</p>
<p class="p1"><span class="Apple-converted-space">            </span>doc.setTextColor(0, 0, 0);</p>
<p class="p1"><span class="Apple-converted-space">            </span>doc.text('DATI CLIENTE', 20, 65);</p>
<p class="p1"><span class="Apple-converted-space">            </span>doc.text('Cliente: ' + ultimoPreventivo.cliente, 20, 75);</p>
<p class="p1"><span class="Apple-converted-space">            </span>doc.text('Data di Nascita: ' + ultimoPreventivo.dataNascita + ' (' + ultimoPreventivo.eta + ' anni)', 20, 85);</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (ultimoPreventivo.telefono) doc.text('Telefono: ' + ultimoPreventivo.telefono, 20, 95);</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (ultimoPreventivo.email) doc.text('Email: ' + ultimoPreventivo.email, 20, 105);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Dettagli evento</p>
<p class="p1"><span class="Apple-converted-space">            </span>var y = ultimoPreventivo.email ? 120 : (ultimoPreventivo.telefono ? 110 : 100);</p>
<p class="p1"><span class="Apple-converted-space">            </span>doc.text('DETTAGLI EVENTO', 20, y);</p>
<p class="p1"><span class="Apple-converted-space">            </span>y += 10;</p>
<p class="p1"><span class="Apple-converted-space">            </span>doc.text('Data e Ora: ' + ultimoPreventivo.dataEvento + ' ore ' + ultimoPreventivo.ora, 20, y);</p>
<p class="p1"><span class="Apple-converted-space">            </span>y += 10;</p>
<p class="p1"><span class="Apple-converted-space">            </span>doc.text('Partecipanti: ' + ultimoPreventivo.adulti + ' adulti + ' + ultimoPreventivo.bambini + ' bambini', 20, y);</p>
<p class="p1"><span class="Apple-converted-space">            </span>y += 10;</p>
<p class="p1"><span class="Apple-converted-space">            </span>doc.text('Spazio: ' + ultimoPreventivo.spazio, 20, y);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Menu</p>
<p class="p1"><span class="Apple-converted-space">            </span>y += 20;</p>
<p class="p1"><span class="Apple-converted-space">            </span>doc.text('MENU SELEZIONATI', 20, y);</p>
<p class="p1"><span class="Apple-converted-space">            </span>y += 10;</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (ultimoPreventivo.nomeMenuAdulti) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>doc.text(ultimoPreventivo.nomeMenuAdulti + ' (x' + ultimoPreventivo.adulti + '): €' + ultimoPreventivo.costoAdulti.toFixed(2), 20, y);</p>
<p class="p1"><span class="Apple-converted-space">                </span>y += 10;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (ultimoPreventivo.nomeMenuBambini) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>doc.text(ultimoPreventivo.nomeMenuBambini + ' (x' + ultimoPreventivo.bambini + '): €' + ultimoPreventivo.costoBambini.toFixed(2), 20, y);</p>
<p class="p1"><span class="Apple-converted-space">                </span>y += 10;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Servizi</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (ultimoPreventivo.serviziExtra.length &gt; 0) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>y += 10;</p>
<p class="p1"><span class="Apple-converted-space">                </span>doc.text('SERVIZI AGGIUNTIVI', 20, y);</p>
<p class="p1"><span class="Apple-converted-space">                </span>y += 10;</p>
<p class="p1"><span class="Apple-converted-space">                </span>ultimoPreventivo.serviziExtra.forEach(function(servizio) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>doc.text('• ' + servizio, 20, y);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>y += 8;</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Totale</p>
<p class="p1"><span class="Apple-converted-space">            </span>y += 10;</p>
<p class="p1"><span class="Apple-converted-space">            </span>doc.setFontSize(14);</p>
<p class="p1"><span class="Apple-converted-space">            </span>doc.setTextColor(61, 90, 61);</p>
<p class="p1"><span class="Apple-converted-space">            </span>doc.text('TOTALE: €' + ultimoPreventivo.totale.toFixed(2), 20, y);</p>
<p class="p1"><span class="Apple-converted-space">            </span>y += 10;</p>
<p class="p1"><span class="Apple-converted-space">            </span>doc.text('Anticipo (30%): €' + ultimoPreventivo.anticipo.toFixed(2), 20, y);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Condizioni</p>
<p class="p1"><span class="Apple-converted-space">            </span>y += 20;</p>
<p class="p1"><span class="Apple-converted-space">            </span>doc.setFontSize(10);</p>
<p class="p1"><span class="Apple-converted-space">            </span>doc.setTextColor(0, 0, 0);</p>
<p class="p1"><span class="Apple-converted-space">            </span>doc.text('CONDIZIONI:', 20, y);</p>
<p class="p1"><span class="Apple-converted-space">            </span>y += 8;</p>
<p class="p1"><span class="Apple-converted-space">            </span>doc.text('• Anticipo: 30% del totale', 20, y);</p>
<p class="p1"><span class="Apple-converted-space">            </span>y += 6;</p>
<p class="p1"><span class="Apple-converted-space">            </span>doc.text('• Cancellazione fino a 7 giorni prima: si perde l\'anticipo', 20, y);</p>
<p class="p1"><span class="Apple-converted-space">            </span>y += 6;</p>
<p class="p1"><span class="Apple-converted-space">            </span>doc.text('• Cancellazione da 6 giorni prima: va versato il 50% dell\'evento', 20, y);</p>
<p class="p1"><span class="Apple-converted-space">            </span>y += 6;</p>
<p class="p1"><span class="Apple-converted-space">            </span>doc.text('• Bevande alcoliche a pagamento a parte', 20, y);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Salva il PDF</p>
<p class="p1"><span class="Apple-converted-space">            </span>doc.save('Preventivo_' + ultimoPreventivo.numero + '_' + ultimoPreventivo.cliente.replace(' ', '_') + '.pdf');</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function changeCount(tipo, delta) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>var input = document.getElementById(tipo);</p>
<p class="p1"><span class="Apple-converted-space">            </span>var currentValue = parseInt(input.value) || 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>var newValue = Math.max(0, currentValue + delta);</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (tipo === 'adulti' &amp;&amp; newValue &gt; 200) return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (tipo === 'bambini' &amp;&amp; newValue &gt; 50) return;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>input.value = newValue;</p>
<p class="p1"><span class="Apple-converted-space">            </span>updateTotaleOspiti();</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function updateTotaleOspiti() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>var adulti = parseInt(document.getElementById('adulti').value) || 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>var bambini = parseInt(document.getElementById('bambini').value) || 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>var totale = adulti + bambini;</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('totaleOspiti').textContent = totale;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>document.getElementById('preventivoForm').addEventListener('submit', function(e) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>e.preventDefault();</p>
<p class="p1"><span class="Apple-converted-space">            </span>generaPreventivo();</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>async function generaPreventivo() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>var nome = document.getElementById('nome').value.trim();</p>
<p class="p1"><span class="Apple-converted-space">            </span>var cognome = document.getElementById('cognome').value.trim();</p>
<p class="p1"><span class="Apple-converted-space">            </span>var dataNascita = document.getElementById('dataNascita').value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>var telefono = document.getElementById('telefono').value.trim();</p>
<p class="p1"><span class="Apple-converted-space">            </span>var email = document.getElementById('email').value.trim();</p>
<p class="p1"><span class="Apple-converted-space">            </span>var data = document.getElementById('data').value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>var ora = document.getElementById('ora').value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>var adulti = parseInt(document.getElementById('adulti').value) || 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>var bambini = parseInt(document.getElementById('bambini').value) || 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>var spazio = document.getElementById('spazio').value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>var menuAdulti = document.querySelector('input[name="menuAdulti"]:checked');</p>
<p class="p1"><span class="Apple-converted-space">            </span>var menuBambini = document.querySelector('input[name="menuBambini"]:checked');</p>
<p class="p1"><span class="Apple-converted-space">            </span>var animazione = document.getElementById('animazione').checked;</p>
<p class="p1"><span class="Apple-converted-space">            </span>var allestimento = document.getElementById('allestimento').checked;</p>
<p class="p1"><span class="Apple-converted-space">            </span>var streetPizza = document.getElementById('streetPizza').checked;</p>
<p class="p1"><span class="Apple-converted-space">            </span>var streetSpritz = document.getElementById('streetSpritz').checked;</p>
<p class="p1"><span class="Apple-converted-space">            </span>var streetBbq = document.getElementById('streetBbq').checked;</p>
<p class="p1"><span class="Apple-converted-space">            </span>var streetFriggitoria = document.getElementById('streetFriggitoria').checked;</p>
<p class="p1"><span class="Apple-converted-space">            </span>var streetGraffe = document.getElementById('streetGraffe').checked;</p>
<p class="p1"><span class="Apple-converted-space">            </span>var altriServizi = document.getElementById('altriServizi').value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>var note = document.getElementById('note').value;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>var totaleOspiti = adulti + bambini;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Validazioni</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (!nome || !cognome || !dataNascita) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>alert('Inserisci nome, cognome e data di nascita');</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (!data || !ora) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>alert('Inserisci data e ora dell\'evento');</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (adulti === 0 &amp;&amp; bambini === 0) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>alert('Inserisci almeno un partecipante');</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (adulti &gt; 0 &amp;&amp; !menuAdulti) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>alert('Seleziona un menu per gli adulti');</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (bambini &gt; 0 &amp;&amp; !menuBambini) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>alert('Seleziona un\'opzione per i bambini');</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Verifica limiti street food</p>
<p class="p1"><span class="Apple-converted-space">            </span>var hasStreetFood = streetPizza || streetSpritz || streetBbq || streetFriggitoria || streetGraffe;</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (hasStreetFood &amp;&amp; totaleOspiti &gt; 50) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>alert('Le postazioni street food sono disponibili solo per eventi fino a 50 persone');</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Capacità spazi</p>
<p class="p1"><span class="Apple-converted-space">            </span>var capacita = {</p>
<p class="p1"><span class="Apple-converted-space">                </span>'sala1': 40,</p>
<p class="p1"><span class="Apple-converted-space">                </span>'sala2': 70,</p>
<p class="p1"><span class="Apple-converted-space">                </span>'esterno': 200,</p>
<p class="p1"><span class="Apple-converted-space">                </span>'sale': 110,</p>
<p class="p1"><span class="Apple-converted-space">                </span>'tutto': 200</p>
<p class="p1"><span class="Apple-converted-space">            </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (totaleOspiti &gt; capacita[spazio]) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>alert('Il numero totale di ospiti (' + totaleOspiti + ') supera la capacità dello spazio selezionato (' + capacita[spazio] + ' posti)');</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Genera numero preventivo</p>
<p class="p1"><span class="Apple-converted-space">            </span>var numeroPreventivo = generaNumeroPreventivo();</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Calcola età</p>
<p class="p1"><span class="Apple-converted-space">            </span>var oggi = new Date();</p>
<p class="p1"><span class="Apple-converted-space">            </span>var nascita = new Date(dataNascita);</p>
<p class="p1"><span class="Apple-converted-space">            </span>var eta = oggi.getFullYear() - nascita.getFullYear();</p>
<p class="p1"><span class="Apple-converted-space">            </span>var meseCorrente = oggi.getMonth();</p>
<p class="p1"><span class="Apple-converted-space">            </span>var giornoCorrente = oggi.getDate();</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (meseCorrente &lt; nascita.getMonth() || (meseCorrente === nascita.getMonth() &amp;&amp; giornoCorrente &lt; nascita.getDate())) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>eta--;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Calcolo costi</p>
<p class="p1"><span class="Apple-converted-space">            </span>var costoAdulti = 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>var costoBambini = 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>var nomeMenuAdulti = '';</p>
<p class="p1"><span class="Apple-converted-space">            </span>var nomeMenuBambini = '';</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Menu Adulti</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (adulti &gt; 0 &amp;&amp; menuAdulti) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>switch(menuAdulti.value) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>case 'rosticceria':</p>
<p class="p1"><span class="Apple-converted-space">                        </span>costoAdulti = adulti * 14;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>nomeMenuAdulti = 'Menu Rosticceria (500g/persona)';</p>
<p class="p1"><span class="Apple-converted-space">                        </span>break;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>case 'bbq':</p>
<p class="p1"><span class="Apple-converted-space">                        </span>costoAdulti = adulti * 40;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>nomeMenuAdulti = 'American BBQ Completo';</p>
<p class="p1"><span class="Apple-converted-space">                        </span>break;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>case 'pizza':</p>
<p class="p1"><span class="Apple-converted-space">                        </span>costoAdulti = adulti * 25;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>nomeMenuAdulti = 'Menu Pizza + Friggitoria';</p>
<p class="p1"><span class="Apple-converted-space">                        </span>break;</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Menu Bambini</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (bambini &gt; 0 &amp;&amp; menuBambini &amp;&amp; menuBambini.value !== 'no-menu') {</p>
<p class="p1"><span class="Apple-converted-space">                </span>costoBambini = bambini * 7.99;</p>
<p class="p1"><span class="Apple-converted-space">                </span>switch(menuBambini.value) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>case 'pasta':</p>
<p class="p1"><span class="Apple-converted-space">                        </span>nomeMenuBambini = 'Menu Bambini - Pasta &amp; Polpette';</p>
<p class="p1"><span class="Apple-converted-space">                        </span>break;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>case 'panino':</p>
<p class="p1"><span class="Apple-converted-space">                        </span>nomeMenuBambini = 'Menu Bambini - Panino &amp; Pizza';</p>
<p class="p1"><span class="Apple-converted-space">                        </span>break;</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>var costoAnimazione = animazione ? 150 : 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>var costoAllestimento = allestimento ? 150 : 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>var costoStreetPizza = streetPizza ? 500 : 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>var costoStreetSpritz = streetSpritz ? 300 : 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>var costoStreetBbq = streetBbq ? 500 : 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>var costoStreetFriggitoria = streetFriggitoria ? 350 : 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>var costoStreetGraffe = streetGraffe ? 250 : 0;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>var costoMenu = costoAdulti + costoBambini;</p>
<p class="p1"><span class="Apple-converted-space">            </span>var costoStreetFood = costoStreetPizza + costoStreetSpritz + costoStreetBbq + costoStreetFriggitoria + costoStreetGraffe;</p>
<p class="p1"><span class="Apple-converted-space">            </span>var totale = costoMenu + costoAnimazione + costoAllestimento + costoStreetFood;</p>
<p class="p1"><span class="Apple-converted-space">            </span>var anticipo = Math.round(totale * 0.3);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Raccogli servizi extra per il PDF</p>
<p class="p1"><span class="Apple-converted-space">            </span>var serviziExtra = [];</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (streetPizza) serviziExtra.push('Postazione Pizza - €500');</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (streetSpritz) serviziExtra.push('Postazione Spritz - €300');</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (streetBbq) serviziExtra.push('Postazione American BBQ - €500');</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (streetFriggitoria) serviziExtra.push('Postazione Friggitoria Napoletana - €350');</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (streetGraffe) serviziExtra.push('Postazione Graffe - €250');</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (animazione) serviziExtra.push('Animazione - €150');</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (allestimento) serviziExtra.push('Allestimento Base - €150');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Salva i dati per PDF e Google Sheets</p>
<p class="p1"><span class="Apple-converted-space">            </span>ultimoPreventivo = {</p>
<p class="p1"><span class="Apple-converted-space">                </span>numero: numeroPreventivo,</p>
<p class="p1"><span class="Apple-converted-space">                </span>cliente: nome + ' ' + cognome,</p>
<p class="p1"><span class="Apple-converted-space">                </span>dataNascita: new Date(dataNascita).toLocaleDateString('it-IT'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>eta: eta,</p>
<p class="p1"><span class="Apple-converted-space">                </span>telefono: telefono,</p>
<p class="p1"><span class="Apple-converted-space">                </span>email: email,</p>
<p class="p1"><span class="Apple-converted-space">                </span>dataEvento: new Date(data).toLocaleDateString('it-IT'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>ora: ora,</p>
<p class="p1"><span class="Apple-converted-space">                </span>adulti: adulti,</p>
<p class="p1"><span class="Apple-converted-space">                </span>bambini: bambini,</p>
<p class="p1"><span class="Apple-converted-space">                </span>spazio: document.getElementById('spazio').options[document.getElementById('spazio').selectedIndex].text,</p>
<p class="p1"><span class="Apple-converted-space">                </span>nomeMenuAdulti: nomeMenuAdulti,</p>
<p class="p1"><span class="Apple-converted-space">                </span>nomeMenuBambini: nomeMenuBambini,</p>
<p class="p1"><span class="Apple-converted-space">                </span>costoAdulti: costoAdulti,</p>
<p class="p1"><span class="Apple-converted-space">                </span>costoBambini: costoBambini,</p>
<p class="p1"><span class="Apple-converted-space">                </span>serviziExtra: serviziExtra,</p>
<p class="p1"><span class="Apple-converted-space">                </span>totale: totale,</p>
<p class="p1"><span class="Apple-converted-space">                </span>anticipo: anticipo</p>
<p class="p1"><span class="Apple-converted-space">            </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Nome spazio</p>
<p class="p1"><span class="Apple-converted-space">            </span>var nomiSpazi = {</p>
<p class="p1"><span class="Apple-converted-space">                </span>'sala1': 'Sala Interna 1 (40 posti)',</p>
<p class="p1"><span class="Apple-converted-space">                </span>'sala2': 'Sala Interna 2 (70 posti)',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>'esterno': 'Spazio Esterno (200 posti)',</p>
<p class="p1"><span class="Apple-converted-space">                </span>'sale': 'Entrambe le Sale Interne (110 posti)',</p>
<p class="p1"><span class="Apple-converted-space">                </span>'tutto': 'Tutto l\'Agriturismo (200 posti)'</p>
<p class="p1"><span class="Apple-converted-space">            </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Formatta data</p>
<p class="p1"><span class="Apple-converted-space">            </span>var dataFormattata = new Date(data).toLocaleDateString('it-IT', {</p>
<p class="p1"><span class="Apple-converted-space">                </span>weekday: 'long',</p>
<p class="p1"><span class="Apple-converted-space">                </span>year: 'numeric',</p>
<p class="p1"><span class="Apple-converted-space">                </span>month: 'long',</p>
<p class="p1"><span class="Apple-converted-space">                </span>day: 'numeric'</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Prepara dati per Google Sheets</p>
<p class="p1"><span class="Apple-converted-space">            </span>var streetFoodList = [];</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (streetPizza) streetFoodList.push('Pizza');</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (streetSpritz) streetFoodList.push('Spritz');</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (streetBbq) streetFoodList.push('BBQ');</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (streetFriggitoria) streetFoodList.push('Friggitoria');</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (streetGraffe) streetFoodList.push('Graffe');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>var serviziList = [];</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (animazione) serviziList.push('Animazione');</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (allestimento) serviziList.push('Allestimento');</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (altriServizi) serviziList.push(altriServizi);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>var datiGoogleSheets = {</p>
<p class="p1"><span class="Apple-converted-space">                </span>numero: numeroPreventivo,</p>
<p class="p1"><span class="Apple-converted-space">                </span>cliente: nome + ' ' + cognome,</p>
<p class="p1"><span class="Apple-converted-space">                </span>telefono: telefono,</p>
<p class="p1"><span class="Apple-converted-space">                </span>email: email,</p>
<p class="p1"><span class="Apple-converted-space">                </span>eventoData: data,</p>
<p class="p1"><span class="Apple-converted-space">                </span>ospitiAdulti: adulti,</p>
<p class="p1"><span class="Apple-converted-space">                </span>ospitiBambini: bambini,</p>
<p class="p1"><span class="Apple-converted-space">                </span>menuAdulti: menuAdulti ? menuAdulti.value : '',</p>
<p class="p1"><span class="Apple-converted-space">                </span>menuBambini: menuBambini ? menuBambini.value : '',</p>
<p class="p1"><span class="Apple-converted-space">                </span>spazio: spazio,</p>
<p class="p1"><span class="Apple-converted-space">                </span>streetFood: streetFoodList.join(', '),</p>
<p class="p1"><span class="Apple-converted-space">                </span>servizi: serviziList.join(', '),</p>
<p class="p1"><span class="Apple-converted-space">                </span>totale: totale,</p>
<p class="p1"><span class="Apple-converted-space">                </span>anticipo: anticipo</p>
<p class="p1"><span class="Apple-converted-space">            </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Genera HTML preventivo</p>
<p class="p1"><span class="Apple-converted-space">            </span>var preventivoHTML = '&lt;div class="preventivo"&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">                </span>'&lt;div class="numero-preventivo"&gt;Preventivo N°: ' + numeroPreventivo + '&lt;/div&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">                </span>'&lt;h2&gt;📋 Preventivo Evento&lt;/h2&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">                </span>'&lt;div class="dettagli"&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">                    </span>'&lt;h3&gt;👤 Dati Cliente&lt;/h3&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">                    </span>'&lt;div class="voce-preventivo"&gt;&lt;span&gt;Cliente:&lt;/span&gt;&lt;span&gt;' + nome + ' ' + cognome + '&lt;/span&gt;&lt;/div&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">                    </span>'&lt;div class="voce-preventivo"&gt;&lt;span&gt;Data di Nascita:&lt;/span&gt;&lt;span&gt;' + new Date(dataNascita).toLocaleDateString('it-IT') + ' (' + eta + ' anni)&lt;/span&gt;&lt;/div&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">                    </span>(telefono ? '&lt;div class="voce-preventivo"&gt;&lt;span&gt;Telefono:&lt;/span&gt;&lt;span&gt;' + telefono + '&lt;/span&gt;&lt;/div&gt;' : '') +</p>
<p class="p1"><span class="Apple-converted-space">                    </span>(email ? '&lt;div class="voce-preventivo"&gt;&lt;span&gt;Email:&lt;/span&gt;&lt;span&gt;' + email + '&lt;/span&gt;&lt;/div&gt;' : '') +</p>
<p class="p1"><span class="Apple-converted-space">                </span>'&lt;/div&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">                </span>'&lt;div class="dettagli"&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">                    </span>'&lt;h3&gt;📅 Dettagli Evento&lt;/h3&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">                    </span>'&lt;div class="voce-preventivo"&gt;&lt;span&gt;Data e Ora:&lt;/span&gt;&lt;span&gt;' + dataFormattata + ' ore ' + ora + '&lt;/span&gt;&lt;/div&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">                    </span>'&lt;div class="voce-preventivo"&gt;&lt;span&gt;Partecipanti:&lt;/span&gt;&lt;span&gt;' + adulti + ' adulti' + (bambini &gt; 0 ? ' + ' + bambini + ' bambini' : '') + ' (Totale: ' + totaleOspiti + ')&lt;/span&gt;&lt;/div&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">                    </span>'&lt;div class="voce-preventivo"&gt;&lt;span&gt;Spazio:&lt;/span&gt;&lt;span&gt;' + nomiSpazi[spazio] + '&lt;/span&gt;&lt;/div&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">                </span>'&lt;/div&gt;';</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (costoMenu &gt; 0) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>preventivoHTML += '&lt;div class="dettagli"&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">                    </span>'&lt;h3&gt;🍽️ Menu Selezionati&lt;/h3&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">                    </span>(adulti &gt; 0 ? '&lt;div class="voce-preventivo"&gt;&lt;span&gt;' + nomeMenuAdulti + ' (x' + adulti + ')&lt;/span&gt;&lt;span&gt;€' + costoAdulti.toFixed(2) + '&lt;/span&gt;&lt;/div&gt;' : '') +</p>
<p class="p1"><span class="Apple-converted-space">                    </span>(bambini &gt; 0 &amp;&amp; menuBambini &amp;&amp; menuBambini.value !== 'no-menu' ? '&lt;div class="voce-preventivo"&gt;&lt;span&gt;' + nomeMenuBambini + ' (x' + bambini + ')&lt;/span&gt;&lt;span&gt;€' + costoBambini.toFixed(2) + '&lt;/span&gt;&lt;/div&gt;' : '') +</p>
<p class="p1"><span class="Apple-converted-space">                    </span>(bambini &gt; 0 &amp;&amp; menuBambini &amp;&amp; menuBambini.value === 'no-menu' ? '&lt;div class="voce-preventivo"&gt;&lt;span&gt;Bambini senza menu (x' + bambini + ')&lt;/span&gt;&lt;span&gt;€0.00&lt;/span&gt;&lt;/div&gt;' : '') +</p>
<p class="p1"><span class="Apple-converted-space">                </span>'&lt;/div&gt;';</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>preventivoHTML += '&lt;div class="dettagli"&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">                </span>'&lt;h3&gt;💰 Riepilogo Costi&lt;/h3&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">                </span>(costoMenu &gt; 0 ? '&lt;div class="voce-preventivo"&gt;&lt;span&gt;Totale Menu&lt;/span&gt;&lt;span&gt;€' + costoMenu.toFixed(2) + '&lt;/span&gt;&lt;/div&gt;' : '') +</p>
<p class="p1"><span class="Apple-converted-space">                </span>(streetPizza ? '&lt;div class="voce-preventivo"&gt;&lt;span&gt;Postazione Pizza&lt;/span&gt;&lt;span&gt;€500.00&lt;/span&gt;&lt;/div&gt;' : '') +</p>
<p class="p1"><span class="Apple-converted-space">                </span>(streetSpritz ? '&lt;div class="voce-preventivo"&gt;&lt;span&gt;Postazione Spritz&lt;/span&gt;&lt;span&gt;€300.00&lt;/span&gt;&lt;/div&gt;' : '') +</p>
<p class="p1"><span class="Apple-converted-space">                </span>(streetBbq ? '&lt;div class="voce-preventivo"&gt;&lt;span&gt;Postazione American BBQ&lt;/span&gt;&lt;span&gt;€500.00&lt;/span&gt;&lt;/div&gt;' : '') +</p>
<p class="p1"><span class="Apple-converted-space">                </span>(streetFriggitoria ? '&lt;div class="voce-preventivo"&gt;&lt;span&gt;Postazione Friggitoria Napoletana&lt;/span&gt;&lt;span&gt;€350.00&lt;/span&gt;&lt;/div&gt;' : '') +</p>
<p class="p1"><span class="Apple-converted-space">                </span>(streetGraffe ? '&lt;div class="voce-preventivo"&gt;&lt;span&gt;Postazione Graffe&lt;/span&gt;&lt;span&gt;€250.00&lt;/span&gt;&lt;/div&gt;' : '') +</p>
<p class="p1"><span class="Apple-converted-space">                </span>(animazione ? '&lt;div class="voce-preventivo"&gt;&lt;span&gt;Animazione&lt;/span&gt;&lt;span&gt;€150.00&lt;/span&gt;&lt;/div&gt;' : '') +</p>
<p class="p1"><span class="Apple-converted-space">                </span>(allestimento ? '&lt;div class="voce-preventivo"&gt;&lt;span&gt;Allestimento Base&lt;/span&gt;&lt;span&gt;€150.00&lt;/span&gt;&lt;/div&gt;' : '') +</p>
<p class="p1"><span class="Apple-converted-space">                </span>'&lt;div class="totale"&gt;&lt;strong&gt;TOTALE: €' + totale.toFixed(2) + '&lt;/strong&gt;&lt;/div&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">                </span>'&lt;div style="text-align: center; margin-top: 15px;"&gt;&lt;strong&gt;Anticipo richiesto (30%): €' + anticipo.toFixed(2) + '&lt;/strong&gt;&lt;/div&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">            </span>'&lt;/div&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">            </span>'&lt;div class="dettagli"&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">                </span>'&lt;h3&gt;✅ Servizi Inclusi&lt;/h3&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">                </span>'&lt;p&gt;• Tavoli, sedie, tovagliato e stoviglie monouso&lt;br&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">                </span>'• Parcheggio gratuito&lt;br&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">                </span>'• Uso bagni e riscaldamento&lt;br&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">                </span>'• Bevande analcoliche incluse&lt;br&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">                </span>'• Servizio di sala&lt;/p&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">            </span>'&lt;/div&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">            </span>(altriServizi ? '&lt;div class="dettagli"&gt;&lt;h3&gt;🎭 Altri Servizi Richiesti:&lt;/h3&gt;&lt;p&gt;' + altriServizi + '&lt;/p&gt;&lt;/div&gt;' : '') +</p>
<p class="p1"><span class="Apple-converted-space">            </span>(note ? '&lt;div class="dettagli"&gt;&lt;h3&gt;📝 Note:&lt;/h3&gt;&lt;p&gt;' + note + '&lt;/p&gt;&lt;/div&gt;' : '') +</p>
<p class="p1"><span class="Apple-converted-space">            </span>'&lt;div class="dettagli" style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px; margin-top: 20px; font-size: 14px;"&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">                </span>'&lt;h3&gt;📋 Condizioni di Prenotazione&lt;/h3&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">                </span>'&lt;p&gt;&lt;strong&gt;Anticipo:&lt;/strong&gt; 30% del totale (€' + anticipo.toFixed(2) + ')&lt;br&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">                </span>'&lt;strong&gt;Cancellazione:&lt;/strong&gt;&lt;br&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">                </span>'• Fino a 7 giorni prima: si perde l\'anticipo&lt;br&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">                </span>'• Da 6 giorni prima: va versato il 50% dell\'evento (€' + (totale * 0.5).toFixed(2) + ')&lt;br&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">                </span>'&lt;strong&gt;Bevande alcoliche:&lt;/strong&gt; A pagamento a parte&lt;br&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">                </span>'&lt;strong&gt;Saldo:&lt;/strong&gt; Il giorno dell\'evento&lt;/p&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">            </span>'&lt;/div&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">            </span>'&lt;div class="btn-group"&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">                </span>'&lt;button class="btn btn-secondary" onclick="scaricaPDF()"&gt;📄 Scarica PDF&lt;/button&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">                </span>'&lt;button class="btn btn-success" onclick="salvaEMostraStatus()"&gt;💾 Salva Database&lt;/button&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">            </span>'&lt;/div&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">        </span>'&lt;/div&gt;';</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('risultato').innerHTML = preventivoHTML;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Prova a salvare automaticamente in Google Sheets se configurato</p>
<p class="p1"><span class="Apple-converted-space">            </span>var googleSheetUrl = document.getElementById('googleSheetUrl').value.trim();</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (googleSheetUrl) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>var risultatoSalvataggio = await salvaInGoogleSheets(datiGoogleSheets);</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (risultatoSalvataggio.success) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>document.getElementById('risultato').innerHTML +=<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>'&lt;div class="status-panel"&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">                            </span>'&lt;strong&gt;✅ Preventivo salvato automaticamente nel database!&lt;/strong&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">                        </span>'&lt;/div&gt;';</p>
<p class="p1"><span class="Apple-converted-space">                </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>document.getElementById('risultato').innerHTML +=<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>'&lt;div class="status-panel" style="background: rgba(220, 53, 69, 0.1); border-color: #dc3545;"&gt;' +</p>
<p class="p1"><span class="Apple-converted-space">                            </span>'&lt;strong&gt;⚠️ Errore nel salvataggio automatico:&lt;/strong&gt; ' + risultatoSalvataggio.message +</p>
<p class="p1"><span class="Apple-converted-space">                        </span>'&lt;/div&gt;';</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Funzione per salvare manualmente e mostrare status</p>
<p class="p1"><span class="Apple-converted-space">        </span>async function salvaEMostraStatus() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (!ultimoPreventivo) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>alert('Genera prima un preventivo');</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>var googleSheetUrl = document.getElementById('googleSheetUrl').value.trim();</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (!googleSheetUrl) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>alert('Configura prima l\'URL di Google Sheets');</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Prepara i dati per Google Sheets</p>
<p class="p1"><span class="Apple-converted-space">            </span>var datiGoogleSheets = {</p>
<p class="p1"><span class="Apple-converted-space">                </span>numero: ultimoPreventivo.numero,</p>
<p class="p1"><span class="Apple-converted-space">                </span>cliente: ultimoPreventivo.cliente,</p>
<p class="p1"><span class="Apple-converted-space">                </span>telefono: ultimoPreventivo.telefono || '',</p>
<p class="p1"><span class="Apple-converted-space">                </span>email: ultimoPreventivo.email || '',</p>
<p class="p1"><span class="Apple-converted-space">                </span>eventoData: ultimoPreventivo.dataEvento,</p>
<p class="p1"><span class="Apple-converted-space">                </span>ospitiAdulti: ultimoPreventivo.adulti,</p>
<p class="p1"><span class="Apple-converted-space">                </span>ospitiBambini: ultimoPreventivo.bambini,</p>
<p class="p1"><span class="Apple-converted-space">                </span>menuAdulti: ultimoPreventivo.nomeMenuAdulti || '',</p>
<p class="p1"><span class="Apple-converted-space">                </span>menuBambini: ultimoPreventivo.nomeMenuBambini || '',</p>
<p class="p1"><span class="Apple-converted-space">                </span>spazio: ultimoPreventivo.spazio,</p>
<p class="p1"><span class="Apple-converted-space">                </span>streetFood: ultimoPreventivo.serviziExtra.filter(function(s) { return s.includes('Postazione'); }).join(', '),</p>
<p class="p1"><span class="Apple-converted-space">                </span>servizi: ultimoPreventivo.serviziExtra.filter(function(s) { return !s.includes('Postazione'); }).join(', '),</p>
<p class="p1"><span class="Apple-converted-space">                </span>totale: ultimoPreventivo.totale,</p>
<p class="p1"><span class="Apple-converted-space">                </span>anticipo: ultimoPreventivo.anticipo</p>
<p class="p1"><span class="Apple-converted-space">            </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>var risultato = await salvaInGoogleSheets(datiGoogleSheets);</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (risultato.success) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>alert('✅ Preventivo salvato con successo nel database!');</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                </span>alert('❌ Errore nel salvataggio: ' + risultato.message);</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Inizializzazione</p>
<p class="p1"><span class="Apple-converted-space">        </span>updateTotaleOspiti();</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/script&gt;</p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
